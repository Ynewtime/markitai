**⚠️ CRITICAL LANGUAGE RULE: Output language = {language}**
If English → ALL output (title/description/tags/content) must be English.
If Chinese → 所有输出（title/description/tags/正文）必须使用中文。

---

请处理以下 Markdown 文档，完成两个任务：

## 任务 1: 格式优化

【语言原则】
- 尊重原文语言：补充、修正、规范化时必须与原文语言一致
- 英文文档 → 英文标点、英文补充内容
- 中文文档 → 中文标点、中文补充内容

【清理规范】
- 保留幻灯片标记（如 `<!-- Slide X -->`），删除其他 HTML 注释
- 删除 PPT 页眉页脚（通常是重复出现的短文本 + 页码）
- 删除图表残留的孤立数字行
- 删除无意义的重复标题

【空行规范】
- 标题(#)前后各保留一个空行
- 代码块(```)前后各保留一个空行
- 列表块前后各保留一个空行
- 表格前后各保留一个空行
- 段落间保留一个空行，删除多余空行

【标点与强调】
- 根据文档语言使用对应标点
- 闭合强调标记放在标点内侧
- 合并连续强调标记
- 粗体/斜体标记与中文之间不加空格

【列表规范】
- 无序列表统一使用 - 符号
- 有序列表使用 1. 2. 3. 格式
- 嵌套列表缩进 2 空格

【段落规范】
- 合并不应断行的段落（同一句话被错误换行）
- 保留有意义的换行（如诗歌、地址）

【表格规范】
- 若列头为空且内容语义清晰，可根据语义补充列头（使用与文档正文一致的语言）
- 若第一列是纯数字行号且无列头，补充列头时使用与文档正文一致的语言

【保持不变】
- 代码块内容
- 表格行列结构（列头补充除外）
- 链接和图片语法
- 原文语义
- **所有 `__MARKIT_*__` 占位符必须原样保留**（如 `__MARKIT_IMG_0__`、`__MARKIT_SLIDE_0__` 等）

## 任务 2: 元数据生成

根据文档内容生成以下元数据：
- title: 文章标题（从内容提取，简洁准确）
- description: 全文摘要（100字以内）
- tags: 相关标签数组（3-5个）

**⚠️ 关键：输出语言必须与源文档保持一致**
- 如果源文档是**英文**，title/description/tags 必须用**英文**
- 如果源文档是**中文**，title/description/tags 必须用**中文**
- 示例：英文文档 → `title: Data Overview`, `tags: [data, excel]`
- 示例：中文文档 → `title: 数据概览`, `tags: [数据, 表格]`

---

源文件: {source}

文档内容:
{content}
