{
  "$defs": {
    "BatchConfig": {
      "description": "Batch processing configuration.",
      "properties": {
        "concurrency": {
          "default": 10,
          "title": "Concurrency",
          "type": "integer"
        },
        "state_flush_interval_seconds": {
          "default": 5,
          "title": "State Flush Interval Seconds",
          "type": "integer"
        },
        "scan_max_depth": {
          "default": 5,
          "title": "Scan Max Depth",
          "type": "integer"
        },
        "scan_max_files": {
          "default": 10000,
          "title": "Scan Max Files",
          "type": "integer"
        }
      },
      "title": "BatchConfig",
      "type": "object"
    },
    "ImageConfig": {
      "description": "Image processing configuration.",
      "properties": {
        "alt_enabled": {
          "default": false,
          "description": "Generate alt text for images via LLM",
          "title": "Alt Enabled",
          "type": "boolean"
        },
        "desc_enabled": {
          "default": false,
          "description": "Generate description files for images",
          "title": "Desc Enabled",
          "type": "boolean"
        },
        "compress": {
          "default": true,
          "title": "Compress",
          "type": "boolean"
        },
        "quality": {
          "default": 85,
          "maximum": 100,
          "minimum": 1,
          "title": "Quality",
          "type": "integer"
        },
        "format": {
          "default": "jpeg",
          "enum": [
            "jpeg",
            "png",
            "webp"
          ],
          "title": "Format",
          "type": "string"
        },
        "max_width": {
          "default": 1920,
          "title": "Max Width",
          "type": "integer"
        },
        "max_height": {
          "default": 1080,
          "title": "Max Height",
          "type": "integer"
        },
        "filter": {
          "$ref": "#/$defs/ImageFilterConfig"
        }
      },
      "title": "ImageConfig",
      "type": "object"
    },
    "ImageFilterConfig": {
      "description": "Image filter configuration.",
      "properties": {
        "min_width": {
          "default": 50,
          "title": "Min Width",
          "type": "integer"
        },
        "min_height": {
          "default": 50,
          "title": "Min Height",
          "type": "integer"
        },
        "min_area": {
          "default": 5000,
          "title": "Min Area",
          "type": "integer"
        },
        "deduplicate": {
          "default": true,
          "title": "Deduplicate",
          "type": "boolean"
        }
      },
      "title": "ImageFilterConfig",
      "type": "object"
    },
    "LLMConfig": {
      "description": "LLM configuration.",
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        },
        "model_list": {
          "items": {
            "$ref": "#/$defs/ModelConfig"
          },
          "title": "Model List",
          "type": "array"
        },
        "router_settings": {
          "$ref": "#/$defs/RouterSettings"
        },
        "concurrency": {
          "default": 10,
          "title": "Concurrency",
          "type": "integer"
        }
      },
      "title": "LLMConfig",
      "type": "object"
    },
    "LiteLLMParams": {
      "description": "LiteLLM parameters for a model.",
      "properties": {
        "model": {
          "title": "Model",
          "type": "string"
        },
        "api_key": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Api Key"
        },
        "api_base": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Api Base"
        },
        "weight": {
          "default": 1,
          "title": "Weight",
          "type": "integer"
        }
      },
      "required": [
        "model"
      ],
      "title": "LiteLLMParams",
      "type": "object"
    },
    "LogConfig": {
      "description": "Logging configuration.",
      "properties": {
        "level": {
          "default": "DEBUG",
          "enum": [
            "DEBUG",
            "INFO",
            "WARNING",
            "ERROR",
            "CRITICAL"
          ],
          "title": "Level",
          "type": "string"
        },
        "dir": {
          "anyOf": [
            { "type": "string" },
            { "type": "null" }
          ],
          "default": "~/.markit/logs",
          "title": "Dir"
        },
        "rotation": {
          "default": "10 MB",
          "title": "Rotation",
          "type": "string"
        },
        "retention": {
          "default": "7 days",
          "title": "Retention",
          "type": "string"
        }
      },
      "title": "LogConfig",
      "type": "object"
    },
    "ModelConfig": {
      "description": "Model configuration for LiteLLM Router.",
      "properties": {
        "model_name": {
          "title": "Model Name",
          "type": "string"
        },
        "litellm_params": {
          "$ref": "#/$defs/LiteLLMParams"
        },
        "model_info": {
          "anyOf": [
            {
              "$ref": "#/$defs/ModelInfo"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        }
      },
      "required": [
        "model_name",
        "litellm_params"
      ],
      "title": "ModelConfig",
      "type": "object"
    },
    "ModelInfo": {
      "description": "Model metadata.",
      "properties": {
        "supports_vision": {
          "default": false,
          "title": "Supports Vision",
          "type": "boolean"
        },
        "max_tokens": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Max Tokens"
        }
      },
      "title": "ModelInfo",
      "type": "object"
    },
    "OCRConfig": {
      "description": "OCR configuration.",
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        },
        "lang": {
          "default": "zh",
          "title": "Lang",
          "type": "string"
        }
      },
      "title": "OCRConfig",
      "type": "object"
    },
    "ScreenshotConfig": {
      "description": "Screenshot rendering configuration.",
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        }
      },
      "title": "ScreenshotConfig",
      "type": "object"
    },
    "OutputConfig": {
      "description": "Output configuration.",
      "properties": {
        "dir": {
          "default": "./output",
          "title": "Dir",
          "type": "string"
        },
        "on_conflict": {
          "default": "rename",
          "description": "Conflict resolution strategy: skip (skip existing), overwrite (replace), rename (add sequence number)",
          "enum": ["skip", "overwrite", "rename"],
          "title": "On Conflict",
          "type": "string"
        },
        "allow_symlinks": {
          "default": false,
          "title": "Allow Symlinks",
          "type": "boolean"
        }
      },
      "title": "OutputConfig",
      "type": "object"
    },
    "PromptsConfig": {
      "description": "Prompts configuration.",
      "properties": {
        "dir": {
          "default": "~/.markit/prompts",
          "title": "Dir",
          "type": "string"
        },
        "cleaner": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Cleaner"
        },
        "frontmatter": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Frontmatter"
        },
        "image_caption": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Image Caption"
        },
        "image_description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Image Description"
        },
        "image_analysis": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Combined image analysis prompt (caption + description)",
          "title": "Image Analysis"
        },
        "page_content": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Page content extraction prompt",
          "title": "Page Content"
        },
        "document_enhance": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Document enhancement prompt",
          "title": "Document Enhance"
        }
      },
      "title": "PromptsConfig",
      "type": "object"
    },
    "PresetConfig": {
      "description": "Preset configuration defining which features to enable.",
      "properties": {
        "llm": {
          "default": false,
          "description": "Enable LLM processing",
          "title": "LLM",
          "type": "boolean"
        },
        "ocr": {
          "default": false,
          "description": "Enable OCR",
          "title": "OCR",
          "type": "boolean"
        },
        "alt": {
          "default": false,
          "description": "Enable alt text generation",
          "title": "Alt",
          "type": "boolean"
        },
        "desc": {
          "default": false,
          "description": "Enable description file generation",
          "title": "Desc",
          "type": "boolean"
        },
        "screenshot": {
          "default": false,
          "description": "Enable page screenshots",
          "title": "Screenshot",
          "type": "boolean"
        }
      },
      "title": "PresetConfig",
      "type": "object"
    },
    "RouterSettings": {
      "description": "LiteLLM Router settings.",
      "properties": {
        "routing_strategy": {
          "default": "simple-shuffle",
          "enum": [
            "simple-shuffle",
            "least-busy",
            "usage-based-routing",
            "latency-based-routing"
          ],
          "title": "Routing Strategy",
          "type": "string"
        },
        "num_retries": {
          "default": 2,
          "title": "Num Retries",
          "type": "integer"
        },
        "timeout": {
          "default": 120,
          "title": "Timeout",
          "type": "integer"
        },
        "fallbacks": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Fallbacks",
          "type": "array"
        }
      },
      "title": "RouterSettings",
      "type": "object"
    }
  },
  "description": "Configuration schema for Markit document converter",
  "properties": {
    "output": {
      "$ref": "#/$defs/OutputConfig"
    },
    "llm": {
      "$ref": "#/$defs/LLMConfig"
    },
    "image": {
      "$ref": "#/$defs/ImageConfig"
    },
    "ocr": {
      "$ref": "#/$defs/OCRConfig"
    },
    "screenshot": {
      "$ref": "#/$defs/ScreenshotConfig"
    },
    "prompts": {
      "$ref": "#/$defs/PromptsConfig"
    },
    "batch": {
      "$ref": "#/$defs/BatchConfig"
    },
    "log": {
      "$ref": "#/$defs/LogConfig"
    },
    "presets": {
      "additionalProperties": {
        "$ref": "#/$defs/PresetConfig"
      },
      "default": {},
      "description": "Custom preset definitions",
      "title": "Presets",
      "type": "object"
    }
  },
  "title": "Markit Configuration",
  "type": "object",
  "$schema": "https://json-schema.org/draft/2020-12/schema"
}
